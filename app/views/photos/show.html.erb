<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-sm">
        <% if @photo.image.present? %>
          <%= image_tag @photo.image.url, alt: @photo.title, class: "card-img-top" %>
        <% end %>
        <div class="card-body">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <div class="d-flex align-items-center">
              <div class="me-3">
                <%= link_to user_path(@photo.user) do %>
                  <% if @photo.user.avatar.present? %>
                    <%= image_tag @photo.user.avatar, 
                                class: "rounded-circle", 
                                style: "width: 40px; height: 40px; object-fit: cover;" %>
                  <% else %>
                    <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center text-white fw-bold" 
                         style="width: 40px; height: 40px;">
                      <%= @photo.user.first_name&.first&.upcase %><%= @photo.user.last_name&.first&.upcase %>
                    </div>
                  <% end %>
                <% end %>
              </div>
              <div>
                <%= link_to user_path(@photo.user), class: "text-decoration-none text-dark" do %>
                  <h6 class="mb-0 fw-bold"><%= @photo.user.first_name %> <%= @photo.user.last_name %></h6>
                <% end %>
                <small class="text-muted">
                  <%= (@photo.publication_date || @photo.created_at).strftime("%d %b %Y") %>
                </small>
              </div>
            </div>
            <% if current_user == @photo.user %>
              <div class="dropdown">
                <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                  Actions
                </button>
                <ul class="dropdown-menu">
                  <li><%= link_to "Edit", edit_photo_path(@photo), class: "dropdown-item" %></li>
                  <li><hr class="dropdown-divider"></li>
                  <li>
                    <%= link_to "Delete", photo_path(@photo), 
                        method: :delete, 
                        confirm: "Are you sure you want to delete this photo?", 
                        class: "dropdown-item text-danger" %>
                  </li>
                </ul>
              </div>
            <% end %>
          </div>
          <h4 class="card-title mb-3"><%= @photo.title %></h4>
          <% if @photo.description.present? %>
            <p class="card-text"><%= @photo.description %></p>
          <% end %>
          <div class="d-flex align-items-center justify-content-between pt-3 border-top">
            <button class="btn btn-link p-0 text-decoration-none like-btn" data-photo-id="<%= @photo.id %>">
              <i class="far fa-heart me-2"></i>
              <span class="like-count"><%= @photo.likes_count || 0 %></span>
            </button>
            <div class="d-flex gap-2">
              <%= link_to "Back to Feed", feeds_photos_path, class: "btn btn-outline-secondary btn-sm" %>
              <% if current_user == @photo.user %>
                <%= link_to "My Photos", user_photos_path(current_user), class: "btn btn-outline-primary btn-sm" %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>